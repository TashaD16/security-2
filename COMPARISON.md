# Сравнение подходов к авторизации

## Вариант 1: Кастомные мета-аннотации (РЕКОМЕНДУЕТСЯ) ✅

### Преимущества:
- ✅ **Самый компактный** - одна аннотация вместо длинной строки
- ✅ **Самый читаемый** - `@RequireReadDeclaration` понятнее чем `@PreAuthorize("hasAuthority('READ_DECLARATION') or hasAuthority('ADMIN')")`
- ✅ **DRY принцип** - правила определены в одном месте
- ✅ **Типобезопасность** - ошибки видны на этапе компиляции
- ✅ **Легко рефакторить** - изменение правила в одном месте
- ✅ **Современный подход** - используется в Spring Boot 3.x
- ✅ **Меньше кода в SecurityConfig** - только общие правила

### Недостатки:
- ⚠️ Нужно создать аннотации (но это делается один раз)

### Пример использования:
```java
@GetMapping("/{declarationId}")
@RequireReadDeclaration
public ResponseEntity<DeclarationDto> getDeclaration(@PathVariable String declarationId) {
    // ...
}
```

---

## Вариант 2: Прямое использование @PreAuthorize

### Преимущества:
- ✅ Стандартный Spring Security подход
- ✅ Не требует дополнительных файлов

### Недостатки:
- ❌ **Менее компактный** - длинные строки в каждом методе
- ❌ **Дублирование кода** - одно и то же правило повторяется
- ❌ **Сложнее поддерживать** - изменение правила требует правок во многих местах
- ❌ **Легко ошибиться** - опечатки в строках не видны на этапе компиляции

### Пример использования:
```java
@GetMapping("/{declarationId}")
@PreAuthorize("hasAuthority('READ_DECLARATION') or hasAuthority('ADMIN')")
public ResponseEntity<DeclarationDto> getDeclaration(@PathVariable String declarationId) {
    // ...
}
```

---

## Вариант 3: Только SecurityConfig (текущий подход)

### Преимущества:
- ✅ Централизованная конфигурация

### Недостатки:
- ❌ **Менее гибкий** - сложно настроить разные правила для разных методов
- ❌ **Больше кода в конфиге** - много правил для каждого эндпоинта
- ❌ **Сложнее читать** - правила далеко от кода, который они защищают
- ❌ **Дублирование** - правила в конфиге и в контроллерах

---

## Рекомендация

**Использовать Вариант 1 (кастомные мета-аннотации)** - это самый современный, компактный и поддерживаемый подход.

### Почему:
1. **Продуктивность**: Меньше кода, быстрее разработка
2. **Компактность**: Одна аннотация вместо длинной строки
3. **Современность**: Соответствует best practices Spring Boot 3.x
4. **Поддерживаемость**: Легко изменять правила в одном месте

### Итоговая архитектура:
- **SecurityConfig**: Только общие правила (публичные эндпоинты, требование аутентификации)
- **Контроллеры**: Кастомные аннотации для детальной авторизации
- **Кастомные аннотации**: Переиспользуемые, типобезопасные правила
